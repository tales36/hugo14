---
title: "STG305_Build_Hybrid_Stotage_Archetectures_With_AWS_Storage_Gateway"
date: 2019-12-05T08:23:01+09:00
author: "katsutoshi miyata"
tags: ["勉強系","AWS re:invent2019"]
cover: ../../img/awsreinvent2019.jpg
---

## ■AWSストレージゲートウェイとは
### ◆オンプレミスと仮想クラウドストレージとのアクセスを確立させるゲートウェイ。

NFSやiSCSIと、S3やEBS、Amazon Backup、Glacierとを直接結ぶことができる。

例
[NFS] -  {SGW}(HTTPS) - [S3]

## ■ゲートウェイの種類
### ◆File Gateway
S3に配置されたファイルをNFSやSMBからHTTPSを経由して接続が可能。  
　→読み込みパフォーマンス4.8Gbpsに向上(new)  
　　→ディレクトリリストの性能が4倍に(new)

### ◆Volume Gateway
SnapshotがiSCSI経由でHTTPSから接続が可能。  

### ◆Tape Gateway
テープバックアップをiSCSI VTL経由でHTTPSから繋げる。  
　→クラウドへの読み込み速度が2Gbpsに。

## ■2018年からの更新点
### ◆リージョン
使えるリージョンが5拠点増え、全部で20リージョン使えるように。

### ◆ハードウェア
ストレージゲートウェイのアプライアンスがEUでも対応可能に。
大きなキャッシュも対応可能に。(5TB～12TBまで)

### ■追加メンテナンスウィンドウ
ゲートウェイソフトウェアの保守を自動化。
週に一度と月に一度のどちらかを現状でも選べるが、  
まもなく、月のうちの週の一日、毎日メンテナンスも選べるように  
### **→これでAWS Storage Gatewayの運用を別途用意しなくても良い。**

### 

## ■AWSストレージゲートウェイのユースケース
### ◆NAS BackupからCloudストレージゲートウェイに切り替えよう。
アプリケーションでファイルを加工する必要もない。

### ◆低レイテンシでクラウドデータにアクセスしたい。
S3の場合、File Gatewayを推奨。
　→利用するデータはSnow ballでアップロードし、フルマネージドのゲートウェイで低レイテンシなデータを活用できる。

## ■CloudwatchでCloudゲートウェイの監視ができるように。
### ◆監視の種類
クライアントおよびクラウドのトラフィック、キャッシュのヒット率やCPU使用率、SMBのセッション数まで。  
　→index Cacheなど。  
　　→ヘルスチェックのカウントもできるので、これで死活監視ができる。

### ◆イベント駆動
ストレージゲートウェイからのイベントをCloudwatchを経由して、SNSかLambdaを動かすことができる。  
　　→SNSはAvailability Events、パフォーマンスメトリクスが新たに加わった。  
　　→Lambdaはキャッシュをリフレッシュしたり、通知を送ったり、オブジェクトをグレイシアに自動で送ったりできる。

## ■感想
前々から気になってたサービスだけど、しっかり勉強出来て良かった。  
S3とかスナップショットに直接NFSでアクセスできるのはとても気になるので検証してみたい。  
しかしテープバックアップもまだまだ無くなりそうにないですね。テープゲートウェイで根絶してしまいたい。